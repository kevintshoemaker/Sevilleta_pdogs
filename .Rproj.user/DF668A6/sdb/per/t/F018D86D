{
    "collab_server" : "",
    "contents" : "\n\n## clear the environment\nrm(list=ls())\n\nANA = F\nKEVIN = F\nKEVINOFFICE = F\nELIZABETH = T\n\n###################################\n##########  SET WORKING DIRECTORY\n\nif(KEVIN) rootDir <- \"C:\\\\Users\\\\Kevin\\\\Dropbox\\\\Sev Pdog Study\\\\BIG plot study\\\\\"\nif(KEVINOFFICE) rootDir <- \"E:\\\\Dropbox\\\\Sev Pdog Study\\\\BIG plot study\\\\\"\nif(ANA) rootDir <- \"\"\nif(ELIZABETH) rootDir <- \"~/Dropbox/Nevada/Sevilleta/Sev Pdog Study/BIG plot study/\"\n\nScriptDir <- paste(rootDir,\"Rscript\",sep=\"\")\nDataDir <- paste(rootDir,\"Data\",sep=\"\")\nFiguresDir <- paste(rootDir,\"RawFigures\",sep=\"\")\nResultsDir <- paste(rootDir,\"Results\",sep=\"\")\nBUGSDir <- paste(rootDir,\"BUGS\",sep=\"\")\n\nsetwd(BUGSDir)\n\ngetwd()\n\n# setwd(BUGSDir)\n# load(\".RData\")\n\n##################################\n##########  LOAD PACKAGES\n\nlibrary(R2WinBUGS)\nlibrary(lubridate)\nlibrary(Hmisc)\n\n\n################################\n########## LOAD MODEL RESULTS AND GLOBAL PARAMETERS\nsetwd(BUGSDir)\nload(\"SevModel10_1mnth_newprecip_2016-07-16.RData\")\n#load(\"SevModel_2015-11-25.RData\")   # load the latest BUGS results\n\nsetwd(DataDir)\nload(\"GlobalParams.RData\")\n\n\n\n#################################\n########  HISTOGRAMS OF FITTED PARAMS\n#################################\n\n## names(Mod$sims.list)\n\n#hist(Mod$sims.list$pbadyr)\nhist(Mod$sims.list$precipEff)    # no discernible precip effect anymore\nhist(Mod$sims.list$relEff)       # very strong negative release effect (what about interactions?)\n#hist(Mod$sims.list$predEff)\nhist(Mod$sims.list$p0)\nhist(Mod$sims.list$phi0)\n\nhist(Mod$sims.list$maleEff)\nhist(Mod$sims.list$juvEff)      # no longer has any effect- it was all a release-year effect  \n\n#hist(Mod$sims.list$juvRelEff)   # interesting- released juveniles do MUCH better than released adults\nhist(Mod$sims.list$springRelEff)  # wow- spring releases do much worse than fall releases???\n\nhist(Mod$sims.list$soilEff)    # not much soil effect- slightly negative!\n\nhist(Mod$sims.list$hoardEff)\n\n#hist(Mod$sims.list$cohortEff[,6])\nhist(Mod$sims.list$tagRetentionRate)\n\n###############################\n############  PlOT OUT RESULTS\n###############################\n\n\n\n\n#################################\n############  ABUNDANCE\n#################################\n\n\n# NOTE: to really use the H-T estimator here, do we need to account for tag loss?? To estimate abundance,\n  ##  we need to be able to know the number of individuals sampled and the probability of capture. We DONT\n  ##  need to account for tag loss! So, the code below should work fine...\n\n\n\n## should include information about the number of releases. \n\nsetwd(FiguresDir)\n\n## Plot out the population size estimates for each site on one graph\n\nGrids <- c(\"B\",\"D\",\"F\")\n\nplot=1\nfor(plot in 1:length(Grids)){\n  thisGrid <- Grids[plot]\n  \n  graphics.off()\n  setwd(FiguresDir)\n  filename=sprintf(\"Abundance_Time_grid%s_F%s.svg\",thisGrid,Sys.Date())\n  svg(file=filename,height=6,width=5)\n  N.mean <- numeric(nperiodsG-1)\n  N.97.5 <- numeric(nperiodsG-1)\n  N.02.5 <- numeric(nperiodsG-1)\n  for(t in 1:(nperiodsG-1)){\n    N.mean[t] <- eval(parse(text=sprintf(\"mean(Mod$sims.list$N_plot%s[,t])\",thisGrid)))\n    N.97.5[t] <- eval(parse(text=sprintf(\"quantile(Mod$sims.list$N_plot%s[,t],.975)\",thisGrid)))\n    N.02.5[t] <- eval(parse(text=sprintf(\"quantile(Mod$sims.list$N_plot%s[,t],.025)\",thisGrid)))\n  }\n     # extract the number of releases for this grid\n  releases <- as.vector(as.matrix(sumReleases)[thisGrid,])\n  \n  par(mai=c(2,1,1,1))\n  plot(c(1:(nperiodsG)),releases, type=\"h\", lend=1, lwd=10,col=gray(0.3),\n       main=sprintf(\"Pdog abundance, sampling grid %s\",thisGrid), ylab=\"# prairie dogs\", xlab=\"\",\n       ylim=c(0,max(releases)),xaxt=\"n\")\n  errbar(x=c(2:(nperiodsG)),y=N.mean,yplus=N.97.5,yminus=N.02.5,add=T,pch=20)\n  axis(1,at=c(1:(nperiodsG)),labels=realperiodsG,las=2)\n  dev.off()\n}\n\n#All plots together now (I'm not sure if these sums across plots are the correct way to do this,\n#but the Ntot estimates were way too high.  But the first period seems to have an N that is way too low??)\nN.mean <- numeric(nperiodsG-1)\nN.97.5 <- numeric(nperiodsG-1)\nN.02.5 <- numeric(nperiodsG-1)\nfor(t in 1:(nperiodsG-1)){\n\tN.mean[t] <- sum(mean(Mod$sims.list$N_plotB[,t]), mean(Mod$sims.list$N_plotD[,t]), mean(Mod$sims.list$N_plotF[,t]))\n\tN.97.5[t] <- sum(quantile(Mod$sims.list$N_plotB[,t],.975), quantile(Mod$sims.list$N_plotD[,t],.975), quantile(Mod$sims.list$N_plotF[,t],.975))\n\tN.02.5[t] <- sum(quantile(Mod$sims.list$N_plotB[,t],.025), quantile(Mod$sims.list$N_plotD[,t],.025), quantile(Mod$sims.list$N_plotF[,t],.025))\n  }\n\nreleases <- colSums(as.matrix(sumReleases))\n\nsetwd(FiguresDir)\nfilename=paste(\"Abundance_Time_ALL_\", Sys.Date(), \".pdf\", sep=\"\")\npdf(filename, height=6, width=7)\npar(mai=c(1.5,1,0.2,0.2))\nplot(c(1:(nperiodsG)+0.1),releases, type=\"h\", lend=1, lwd=10,col=gray(0.3),\n       ylab=\"Prairie dog abundance\", xlab=\"\", ylim=c(0,max(releases)),xaxt=\"n\")\nerrbar(x=c(2:(nperiodsG))-0.1,y=N.mean,yplus=N.97.5,yminus=N.02.5,add=T,pch=19)\naxis(1,at=c(1:(nperiodsG)),labels=c(\"Summer 2010\", \"Summer 2011\", \"Spring 2012\", \"Summer 2012\", \"Spring 2013\", \"Summer 2013\", \"Spring 2014\", \"Summer 2014\", \"Summer[1] 2015\", \"Summer[2] 2015\", \"Spring 2016\", \"Summer 2016\"),las=2)\ndev.off()\n\n##########################\n########  SURVIVAL\n\n\n## Plot out the survival estimates for each site on one graph\n\ngraphics.off()\nsetwd(FiguresDir)\nfilename=sprintf(\"Female Survival_byTime_%s.pdf\",Sys.Date())\npdf(file=filename,height=5,width=5)\nphi.mean <- numeric(nperiodsG-1)\nphi.97.5 <- numeric(nperiodsG-1)\nphi.02.5 <- numeric(nperiodsG-1)\nfor(t in 1:(nperiodsG-1)){\n  phi.mean[t] <- mean(Mod$sims.list$femphi[,t])     # femphi  # malephi    # reladultphi\n  phi.97.5[t] <- quantile(Mod$sims.list$femphi[,t],.975)\n  phi.02.5[t] <- quantile(Mod$sims.list$femphi[,t],.025)\n}\n\npar(mai=c(1.5,1,0.2,0.2))\nplot(c(1:(nperiodsG-1)),phi.mean,\n     ylab=\"Survival rate\", xlab=\"\",type=\"p\",\n     ylim=c(0,1),xaxt=\"n\", las=1)\nerrbar(x=c(1:(nperiodsG-1)),y=phi.mean,yplus=phi.97.5,yminus=phi.02.5,add=T,pch=\"\")\n\naxis(1,at=c(1:(nperiodsG-1)),labels=c(\"Summer 2010\", \"Summer 2011\", \"Spring 2012\", \"Summer 2012\", \"Spring 2013\", \"Summer 2013\", \"Spring 2014\", \"Summer 2014\", \"Spring 2015\", \"Spring 2016\", \"Summer 2016\"),las=2)\ndev.off()\n\n###### \n#### make CSV for Sigma plot\n\nsetwd(ResultsDir)\ntempname <- paste(\"SurvToPlot_\",Sys.Date(),\".csv\",sep=\"\")\nwrite.csv(data.frame(mean=phi.mean,upper=phi.97.5,lower=phi.02.5),tempname)\n\n\nnames(Mod$sims.list)\n\n############\n### visualize difference between released juv, spring released adult fem, spring released adult male, etc\n\n### mean survival of females vs males vs juveniles\n\n# mu.phi[i,t]   <- logit.phi + precipEff*precip[t] + soilEff*soil[t] +      \n#   juvEff*isJuv[i,t] + maleEff*isMale[i] + relEff*isRel[i,t] + \n#   hoardEff*isHoard[i] + juvRelEff*isJuv[i,t]*isRel[i,t] + springRelEff*springRel[i,t]\n\n\nnreps <- length(Mod$sims.list$phi0) \ndims <- 4\ndimnms1 <- c(\"Adult Female\",\"Adult Male\",\"Juvenile Female\",\"Juvenile Male\")    \n\nSurv.fem <- with(Mod$sims.list,plogis(qlogis(phi0)))\nSurv.mal <- with(Mod$sims.list,plogis(qlogis(phi0)+maleEff))\nSurv.juv.fem <- with(Mod$sims.list,plogis(qlogis(phi0)+juvEff))\nSurv.juv.mal <- with(Mod$sims.list,plogis(qlogis(phi0)+maleEff+juvEff))\n\nsetwd(FiguresDir)\nfilename=sprintf(\"Survival_categor_%s.pdf\",Sys.Date()) \npdf(filename, width=7, height=3.5)\n#SexAge plot\npar(mar=c(2,4,1,1))\nalldata <- c(Surv.fem,Surv.mal,Surv.juv.fem,Surv.juv.mal)\nalldatanames <- rep(dimnms1,each=nreps)\nalldata <- data.frame(survival=alldata,group=alldatanames)\nalldata$group <- factor(as.character(alldata$group),levels=dimnms1)\nplot(survival~group,data=alldata)\ndev.off()\n\n\n#Release survival rates\nnreps <- length(Mod$sims.list$phi0) \ndims <- 2\ndimnms1 <- c(\"Spring\",\"Summer\")    \n\nSurv.spr.adt <- Mod$sims.list$springadrelsurv_mo\nSurv.sum.adt <- Mod$sims.list$falladrelsurv_mo\n\nsetwd(FiguresDir)\nfilename=sprintf(\"Survival_releases_categor_%s.pdf\",Sys.Date()) \npdf(filename, width=4, height=3.5)\n#SexAge plot\npar(mar=c(2,4,1,1))\nalldata <- c(Surv.spr.adt, Surv.sum.adt)\nalldatanames <- rep(dimnms1,each=nreps)\nalldata <- data.frame(survival=alldata,group=alldatanames)\nalldata$group <- factor(as.character(alldata$group),levels=dimnms1)\nplot(survival~group,data=alldata, ylab=\"Survival (one month)\")\ndev.off()\n\n\n#################################\n############  FECUNDITY\n#################################\nsetwd(BUGSDir)\nload(\"SevModel3_fert_2016-07-16_1mnth_newprecip.RData\")\n#Histograms of fecundity and lambda\nsetwd(FiguresDir)\nfilename=sprintf(\"Lambda_fert_%s.pdf\",Sys.Date()) \npdf(filename, width=7, height=5)\npar(mfrow=c(2,1), mar=c(4,4,1,1))\nhist(fertoutput, breaks=30, xlab=\"Recruitment (juveniles[F]/female/year)\", main=\"\", xlim=c(0,1.5))\nsegments(x0=0.88, y0=0, x1=0.88, y1=1000, lty=2, lwd=2) #Recruitment needed to reach lambda=1\ntext(x=1.4, y=450, labels=\"(a)\", cex=1.5)\n#Estimates from literature\n#points(x=1.46, y=800, pch=19) #Haynie 2003 estimate\n#arrows(x0=1.46, y0=800, x1=1.46+0.6, y1=800, angle=90, length=0.1)\n#arrows(x0=1.46, y0=800, x1=1.46-0.6, y1=800, angle=90, length=0.1)\n#text(x=1.46, y=700, labels=\"(Haynie et al. 2003)\")\n#points(x=1.89, y=500, pch=19) #Hoogland 2001 estimate\n#arrows(x0=1.89, y0=500, x1=1.89+0.62, y1=500, angle=90, length=0.1)\n#arrows(x0=1.89, y0=500, x1=1.89-0.62, y1=500, angle=90, length=0.1)\n#text(x=1.89, y=400, labels=\"(Hoogland 2001)\")\n#points(x=2.14, y=200, pch=19) #Fitzgerald 1974 estimate\n#arrows(x0=2.14, y0=200, x1=2.14+1.25, y1=200, angle=90, length=0.1)\n#arrows(x0=2.14, y0=200, x1=2.14-1.25, y1=200, angle=90, length=0.1)\n#text(x=2.14, y=100, labels=\"(Fitzgerald & Lechleitner 1974)\")\n#points(x=mean(fertoutput), y=1200, pch=19) #our estimate\n#arrows(x0=mean(fertoutput), y0=1200, x1=mean(fertoutput)+sd(fertoutput), y1=1200, angle=90, length=0.1)\n#arrows(x0=mean(fertoutput), y0=1200, x1=mean(fertoutput)-sd(fertoutput), y1=1200, angle=90, length=0.1)\n#text(x=mean(fertoutput), y=1080, labels=\"(this study)\")\npar(mar=c(4,4,1,1))\nhist(lambda, breaks=50, xlab=\"Population growth rate (lambda)\", main=\"\", xlim=c(0.2,1.55))\nsegments(x0=1, y0=0, x1=1, y1=4000, lty=2, lwd=2)\ntext(x=1.47, y=450, labels=\"(b)\", cex=1.5)\ndev.off()\n\n####\n#Fecundity for each year\nsetwd(FiguresDir)\nfilename=sprintf(\"Fert_year_%s.pdf\",Sys.Date()) \npdf(filename, width=7, height=5)\nplot(density(littersize[temp.12.3]), xlim=c(0,1), xlab=\"Recruitment (juveniles[F]/female/year)\", lwd=3, col=\"orangered4\", main=\"\", ylab=\"Probability density\")\nlines(density(littersize[temp.13.3]), col=\"orangered1\", lwd=3)\nlines(density(littersize[temp.14.3]), col=\"orange\", lwd=3)\nlines(density(littersize[temp.15.3]), col=\"gold\", lwd=3)\nsegments(x0=mean(littersize[temp.12.3]), y0=6, y1=4.6, lty=2, lwd=3, col=\"orangered4\")\nsegments(x0=mean(littersize[temp.13.3]), y0=6, y1=2.95, lty=2, lwd=3, col=\"orangered1\")\nsegments(x0=mean(littersize[temp.14.3]), y0=6, y1=1.65, lty=2, lwd=3, col=\"orange\")\nsegments(x0=mean(littersize[temp.15.3]), y0=6, y1=1.65, lty=2, lwd=3, col=\"gold\")\ntext(x=mean(littersize[temp.12.3]), y=5, labels=\"2012\", col=\"orangered4\", adj=-0.1)\ntext(x=mean(littersize[temp.13.3]), y=5, labels=\"2013\", col=\"orangered1\", adj=-0.1)\ntext(x=mean(littersize[temp.14.3]), y=5, labels=\"2014\", col=\"orange\", adj=-0.1)\ntext(x=mean(littersize[temp.15.3]), y=5, labels=\"2015\", col=\"gold\", adj=-0.1)\ndev.off()\n\n####\n#Lambda for each year\nplot(density(lambda[1:1031]), xlab=\"Lambda\", lwd=3, col=\"orangered4\", main=\"\")\nlines(density(lambda[1032:2062]), col=\"orangered1\", lwd=3)\nlines(density(lambda[2063:3093]), col=\"orange\", lwd=3)\nlines(density(lambda[3094:4124]), col=\"gold\", lwd=3)\nsegments(x0=1, x1=1, y0=0, y1=3, lty=2, lwd=3)\n\n#############################\n#####  write parameter estimates to file\n\nnames(Mod$sims.list)\n\ntempdf = data.frame()   \n\n#\"phi0\",      # mean probability of survival\n#\"pbadyr\",  # probability that a sampling period has low survival (due to predation?)\n#\"badyr\",   # probability that a given season is classified as a bad year...\n#\"precipEff\",   # effect of precip on survival\n#\"maleEff\",     # effect of maleness on survival\n#\"juvEff\",      # effect of being juvenile on survival\n#\"predEff\",     # reduction in survival rate in a bad year\n#\"p0\",            # mean nightly prob. of capture\n#\"gamma.prime\",    # probability of staying off site\n#\"gamma.dprime\"     # probability of leaving from on site\n\n\ncphi0 <- c(mean(Mod$sims.list$phi0),quantile(Mod$sims.list$phi0,0.025),quantile(Mod$sims.list$phi0,0.975))\ncpbadyr <- c(mean(Mod$sims.list$pbadyr),quantile(Mod$sims.list$pbadyr,0.025),quantile(Mod$sims.list$pbadyr,0.975))\ncprecipeff <- c(mean(Mod$sims.list$precipEff),quantile(Mod$sims.list$precipEff,0.025),quantile(Mod$sims.list$precipEff,0.975))\n#cmaleeff   <- c(mean(Mod$sims.list$maleEff),quantile(Mod$sims.list$maleEff,0.025),quantile(Mod$sims.list$maleEff,0.975))\n#cjuveff  <- c(mean(Mod$sims.list$juvEff),quantile(Mod$sims.list$juvEff,0.025),quantile(Mod$sims.list$juvEff,0.975))\ncpredeff  <- c(mean(Mod$sims.list$predEff),quantile(Mod$sims.list$predEff,0.025),quantile(Mod$sims.list$predEff,0.975))\ncp0   <- c(mean(Mod$sims.list$p0),quantile(Mod$sims.list$p0,0.025),quantile(Mod$sims.list$p0,0.975))\ncgammaprime  <- c(mean(Mod$sims.list$gamma.prime),quantile(Mod$sims.list$gamma.prime,0.025),quantile(Mod$sims.list$gamma.prime,0.975))\ncgammadprime  <- c(mean(Mod$sims.list$gamma.dprime),quantile(Mod$sims.list$gamma.dprime,0.025),quantile(Mod$sims.list$gamma.dprime,0.975))\n\n\nparamtable1 <- round(rbind(cphi0,cpbadyr,cprecipeff,cpredeff,cp0,cgammaprime,cgammadprime) ,3)  # cmaleeff,cjuveff,\ncolnames(paramtable1) <- c(\"mean\",\"lower limit 95% CI\",\"upper limit 95% CI\")\nrownames(paramtable1) <- c(\"mean survival\",\"probability of bad year\",\"effect of precipitation on survival (logit)\",\n                           #\"effect of juvenileness on survival (logit)\",\n                           \"reduced survival in bad year (logit)\",\"mean capture probability\",\"probability of staying off sampled region\",\n                           \"probability of leaving sampled region\")   # \"effect of maleness on survival (logit)\",\n\nsetwd(ResultsDir)\ntempname <- paste(\"Parameter_Table1_\",Sys.Date(),\".csv\",sep=\"\")\nwrite.csv(paramtable1,tempname)\n\nsetwd(BUGSDir)\ntempname <- paste(\"LatestWorkspace_\",Sys.Date(),\".RData\",sep=\"\")\nsave.image(file = tempname)\n\n\n\n\n\n\n\n\n##############  FOR SIGMA PLOT...\n\n## Plot out the survival estimates as a function of precipitation\n\ngraphics.off()\n\nsetwd(FiguresDir)\nfilename=sprintf(\"Surv_Precip_%s.svg\",Sys.Date())\nsvg(file=filename,height=5,width=5)\nphi.mean <- numeric(length(xvars))\nphi.97.5 <- numeric(length(xvars))\nphi.02.5 <- numeric(length(xvars))\nt=1\nfor(t in 1:length(xvars)){\n  phi.mean[t] <- mean(precip_matrix[,t])\n  phi.97.5[t] <- quantile(precip_matrix[,t],.975)\n  phi.02.5[t] <- quantile(precip_matrix[,t],.025)\n}\n\npar(mai=c(2,1,1,1))\nplot(c(1:length(xvars)),phi.mean,\n     main=\"Survival vs Precip\", ylab=\"Survival rate\", xlab=\"\",type=\"p\",\n     ylim=c(0,1),xaxt=\"n\")\nerrbar(x=c(1:length(xvars)),y=phi.mean,yplus=phi.97.5,yminus=phi.02.5,add=T,pch=\"\")\n\n#(log(precip)-meanlogprecip)/sdlogprecip\nxlabels <- round(exp((xvars*sdlogprecip)+meanlogprecip),1)\nats <- seq(1,length(xvars),5)\naxis(1,at=ats,labels=xlabels[ats],las=2)\ndev.off()\n\n###### \n#### make CSV for Sigma plot\n\nsetwd(ResultsDir)\ntempname <- paste(\"Surv_Precip_\",Sys.Date(),\".csv\",sep=\"\")\nwrite.table(data.frame(precip=xlabels,mean=phi.mean,upper=phi.97.5,lower=phi.02.5),tempname,sep=\",\",row.names=F)\n\n\n\n###########################################################\n###################################  \n#                     ANA, you can run the code up to this point\n###################\n###########\n#########\n######\n#####\n####\n\n\n\n\n###################################\n#   Run Convergence diagnostics (Gelman-Rubin diagnostic).\n\n#chains <- list()\n#chains[[1]] <- read.coda(\"CCmodel_coda1.txt\", \"CCmodel_index1.txt\")  #,start, end, thin, quiet=FALSE)\n#chains[[2]] <- read.coda(\"CCmodel_coda2.txt\", \"CCmodel_index1.txt\")\n#chains[[3]] <- read.coda(\"CCmodel_coda3.txt\", \"CCmodel_index1.txt\")\n\n#MCMC <- mcmc.list(chains[[1]][,-c(61:69)],chains[[2]][,-c(61:69)],chains[[3]][,-c(61:69)])\n\n\n#GelmanRubinTest <- gelman.diag(MCMC,transform=T)\n#gelman.plot(MCMC)\n\n#  some of the monitored variables have problems with this test, even after transformation...\n# this worked after I got rid of the  \n\n\n\n\n\n\n\n############################\n########  SUMMARIZE STRANGE DATA\n\n#ndx <- which(((caphist2[,1]==1)|(caphist2[,2]==1))&(apply(caphist2[,3:12],1,sum)>0))\n\n#newdf <- data.frame(names[ndx],caphist2[ndx,])\n\n#names(newdf) <- c(\"Left Ear Tag ID\", realperiodsG) \n\n#newdf\n\n#getwd()\n#write.csv(newdf,\"Redflag_survivors.csv\",row.names=F)\n\n\n\n\n\n\n#names(Mod$sims.list)\n\n\n\n#hist(Mod$sims.list$p0)\n\n\n#table(pdogT$PLOT,pdogT$PTP)\n\n\n\n\n\n\n\n######################\n####### ARCHIVE CODE\n\n\n#####################\n### plot out the effect of precip on survival...\n\nnsims=5000 # temporary\nmeanlogprecip <- mean(log(precip))             # standardize precip variable\nsdlogprecip <- sd(log(precip))\nprecip_std <- (log(precip)-meanlogprecip)/sdlogprecip\nxvars <- seq(min(as.vector(precip_std)),max(as.vector(precip_std)),0.05)\n\nnsamples <- 1000\nprecip_matrix <- matrix(nrow=nsamples,ncol=length(xvars))\nfor(s in 1:nsamples){\n  samp <- sample(c(1:nsims),1,replace=F)\n  for(i in 1:length(xvars)){\n    temp <- plogis(qlogis(Mod$sims.list$phi0[samp]) + Mod$sims.list$precipEff[samp]*xvars[i])\n    precip_matrix[s,i] <- temp\n  }\n}\n\nboxplot(precip_matrix)\n\n\n### determine which year is a \"bad year\"\n\nbadsurv_p <- numeric(nperiodsG)\nbadsurv_b <- numeric(nperiodsG)\n\n#  i=1\nfor(i in 1:nperiodsG){\n  ndx <- which(names(table(Mod$sims.list$badyr[,i]))==\"1\")\n  if(length(ndx)>0) temp <- as.numeric(table(Mod$sims.list$badyr[,i]))[ndx]/nsims else temp=1\n  badsurv_p[i] <- temp        #probability of bad survival this period  \n  badsurv_b[i] <- ifelse(temp>0.75,1,0)  # this period designated as bad survival if designated bad more than 75% of the time\n}\n# write this out to file...\nnewdf <- data.frame(period=realperiodsG,prob_highpred_period=badsurv_p,is_highpred_period=badsurv_b)\ntempname <- paste(\"highPredation_\",Sys.Date(),\".csv\",sep=\"\")\n\nsetwd(ResultsDir)\nwrite.table(newdf, file=tempname, sep=\",\",row.names=F)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "created" : 1478568018443.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "874245161",
    "id" : "F018D86D",
    "lastKnownWriteTime" : 1469653793,
    "last_content_update" : 1469653793,
    "path" : "E:/GIT/Sevilleta_pdogs/Sev reintro - BigPlots_Figures3.R",
    "project_path" : "Sev reintro - BigPlots_Figures3.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}